#!/usr/bin/env ruby

def extract_times(str)
  try_split = str.split '-'
  if try_split.length > 1
    start, finish = try_split
  else
    start = str
    finish = nil
  end

  [start, finish]
end

case ARGV.length
when 1
  logfile = '/logs/haproxy.log'
  start, finish = extract_times ARGV[0]
  
when 2
  if File.exist? ARGV[0]
    logfile = ARGV[0]
    start, finish = extract_times ARGV[1]
  elsif File.exist? ARGV[1]
    logfile = ARGV[1]
    start, finish = extract_times ARGV[0]
  end
end

command = logfile
command += " " + start
command += " " + finish if finish

system "lein run :tgrep #{command}"
